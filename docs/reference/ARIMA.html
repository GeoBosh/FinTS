<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="Fit an ARIMA model and test residuals with the Ljung-Box statistic"><title>Arima with Ljung-Box — ARIMA • FinTS</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.1.3/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.1.3/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Arima with Ljung-Box — ARIMA"><meta property="og:description" content="Fit an ARIMA model and test residuals with the Ljung-Box statistic"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">FinTS</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.4-7</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"></ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Arima with Ljung-Box</h1>
      
      <div class="d-none name"><code>ARIMA.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Fit an ARIMA model and test residuals with the Ljung-Box statistic</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">ARIMA</span><span class="op">(</span><span class="va">x</span>, order <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span>,</span>
<span>     seasonal <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>order <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span>, period <span class="op">=</span> <span class="cn">NA</span><span class="op">)</span>,</span>
<span>     xreg <span class="op">=</span> <span class="cn">NULL</span>, include.mean <span class="op">=</span> <span class="cn">TRUE</span>, transform.pars <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>     fixed <span class="op">=</span> <span class="cn">NULL</span>, init <span class="op">=</span> <span class="cn">NULL</span>, method <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"CSS-ML"</span>, <span class="st">"ML"</span>, <span class="st">"CSS"</span><span class="op">)</span>,</span>
<span>     <span class="va">n.cond</span>, optim.control <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span>, kappa <span class="op">=</span> <span class="fl">1e6</span>, Box.test.lag<span class="op">=</span><span class="cn">NULL</span>,</span>
<span>     Box.test.df <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"net.lag"</span>, <span class="st">"lag"</span><span class="op">)</span>,</span>
<span>     type <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Ljung-Box"</span>, <span class="st">"Box-Pierce"</span>, <span class="st">"rank"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>x</dt>
<dd><p>a univariate time series</p></dd>

  <dt>order</dt>
<dd><p>A specification of the non-seasonal part of the ARIMA model:  the
    three components (p, d, q) are the AR order, the degree of
    differencing, and the MA order.</p></dd>

  <dt>seasonal</dt>
<dd><p>A specification of the seasonal part of the ARIMA model, plus the
    period (which defaults to 'frequency(x)'). This should be a list
    with components 'order' and 'period', but a specification of just a
    numeric vector of length 3 will be turned into a suitable list with
    the specification as the 'order'.</p></dd>

  <dt>xreg</dt>
<dd><p>Optionally, a vector or matrix of external regressors, which must
    have the same number of rows as 'x'.</p></dd>

  <dt>include.mean</dt>
<dd><p>Should the ARMA model include a mean/intercept term?  The default is
    'TRUE' for undifferenced series, and it is ignored for ARIMA models
    with differencing.</p></dd>

  <dt>transform.pars</dt>
<dd><p>Logical.  If true, the AR parameters are transformed to ensure that
    they remain in the region of stationarity.  Not used for 'method =
    "CSS"'.</p></dd>

  <dt>fixed</dt>
<dd><p>optional numeric vector of the same length as the total number of
    parameters.  If supplied, only 'NA' entries in 'fixed' will be
    varied.  'transform.pars = TRUE' will be overridden (with a warning)
    if any AR parameters are fixed.  It may be wise to set
    'transform.pars = FALSE' when fixing MA parameters, especially near
    non-invertibility.</p></dd>

  <dt>init</dt>
<dd><p>optional numeric vector of initial parameter values.  Missing values
    will be filled in, by zeroes except for regression coefficients.
    Values already specified in 'fixed' will be ignored.</p></dd>

  <dt>method</dt>
<dd><p>Fitting method: maximum likelihood or minimize conditional
    sum-of-squares.  The default (unless there are missing values) is to
    use conditional-sum-of-squares to find starting values, then maximum
    likelihood.</p></dd>

  <dt>n.cond</dt>
<dd><p>Only used if fitting by conditional-sum-of-squares: the number of
    initial observations to ignore.  It will be ignored if less than the
    maximum lag of an AR term.</p></dd>

  <dt>optim.control</dt>
<dd><p>List of control parameters for 'optim'.</p></dd>

  <dt>kappa</dt>
<dd><p>the prior variance (as a multiple of the innovations variance) for
    the past observations in a differenced model.  Do not reduce this.</p></dd>

  <dt>Box.test.lag</dt>
<dd><p>the Box.test statistic will be based on 'Box.test.lag'
    autocorrelation coefficients of the whitened residuals.
    The default is the maximum of the following:
<!-- %    \itemize{ -->
      <code>round(log(sum(!is.na(x))))</code>, recommended by Tsay (p. 27).</p>
<p>One more than the number of parameters estimated, not counting any
      'intercept' in the model.
<!-- %    } --></p></dd>

  <dt>Box.test.df</dt>
<dd><p>numeric or character variable indicating the degrees of freedom for
    the ch-square approximation to the distribution of the Box.test
    statistic.  The default 'net.lag' is 'Box.test.lag' minus the number
    of relevant parameters estimated.  The primary alternative 'lag' is
    the number of lags included in the computation of the statistic.</p>
<p>A positive number can also be provided.</p></dd>

  <dt>type</dt>
<dd><p>which Box.test 'type' should be used?  Partial matching is used.</p>
<p>The 'rank' alternative computes 'Ljung-Box' on rank(x);  see Burns
    (2002) and references therein.</p>
<p>NOTE:  The default 'Ljung-Box' type generally seems to be more
    accurate and popular than the earlier 'Box-Pierce', which is however
    the default for 'Box.test'.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>1.  Fit the desired model using 'arima'.</p>
<p>2.  Compute the desired number of lags for Box.test</p>
<p>3.  Apply 'AutocorTest' to the whitened residuals.</p>
<p>NOTE:  Some software does not adjust the degrees of freedom for the
  number of parameters estimated.  Tsay (2005) and Enders (2004) do.
  The need to adjust the degrees of freedom discussed by Brockwell and
  Davis (1990), who provide a proof describing the circumstances under
  which this is appropriate.</p>
<p>This is, however, an asymptotic result, and it would help to have
  simulation studies of the distribution of the Ljung-Box statistic,
  estimating degrees of freedom and evaluating goodness of fit.  Burns
  recommends a rank version of the Ljung-Box test, but does not estimate
  degrees of freedom.  If you have done such a simulation or know of a
  reference describing such, would you please notify the maintainer of
  this package?</p>
<p>4.  If 'xreg' is supplied, compute r.squared.</p>
    </div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p>an 'arima' object with an additional 'Box.test' component and if
  'xreg' is not null, an 'r.squared' component.</p>


<p>NOTE:  The 'Box.test' help page in R 2.6.1 says, 'Missing values are
  not handled.'  However, if 'x' contains NAs, 'ARIMA' still returns a
  numeric answer that seems plausible, at least in some examples.
  Therefore, either this comment on the help page is wrong (or obsolete)
  or the answer can not be trusted with NAs.</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Brockwell and Davis (1990) Time Series: Theory and Methods, 2nd
  Edition (Springer, page 310).</p>
<p>Walter Enders (2004) Applied Econometric Time Series (Wiley,
  pp. 68-69)</p>
<p>Greta Ljung and George E. P. Box (1978) 'On a measure of lack of fit
  in time series models', Biometrika, vol. 66, pp. 67-72.</p>
<p>Ruey Tsay (2005) Analysis of Financial Time Series, 2nd ed. (Wiley,
  ch. 2)</p>
<p>Patrick Burns (2002) 'Robustness of the Ljung-Box Test and its Rank
  Equivalent',
  <a href="https://www.burns-stat.com/pages/Working/ljungbox.pdf" class="external-link">https://www.burns-stat.com/pages/Working/ljungbox.pdf</a>, accessed
  2007.12.29.</p>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Spencer Graves for the <code>ARIMA{FinTS}</code> wrapper for
  <code><a href="https://rdrr.io/r/stats/arima.html" class="external-link">arima</a></code>, written by the R Core Team, and
  <code><a href="https://rdrr.io/r/stats/box.test.html" class="external-link">Box.test</a></code>, written by A. Trapletti.  John Frain
  provided the citation to a proof in Brockwell and Davis (1990) that
  the degrees of freedom for the approximating chi-square distribution
  of the Ljung-Box statistic should be adjusted for the number of
  parameters estimated.  Michal Miklovic provided the citation to Enders
  (2004).</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="https://rdrr.io/r/stats/arima.html" class="external-link">arima</a></code>
  <code><a href="https://rdrr.io/r/stats/box.test.html" class="external-link">Box.test</a></code>
  <code><a href="https://rdrr.io/r/stats/tsdiag.html" class="external-link">tsdiag</a></code></p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co">##</span></span></span>
<span class="r-in"><span><span class="co">## Examples from 'arima'</span></span></span>
<span class="r-in"><span><span class="co">##</span></span></span>
<span class="r-in"><span><span class="va">lh100</span> <span class="op">&lt;-</span> <span class="fu">ARIMA</span><span class="op">(</span><span class="va">lh</span>, order <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">0</span>,<span class="fl">0</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">lh100</span><span class="op">$</span><span class="va">Box.test</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 	Box-Ljung test (lag = 4)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> data:  fit$resid</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> X-squared = 5.1851, df = 3, p-value = 0.1587</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span><span class="co"># df = 3 = round(log(lh)) - 1</span></span></span>
<span class="r-in"><span><span class="co"># 2 parameters are estimated, but 1 is 'intercept',</span></span></span>
<span class="r-in"><span><span class="co"># so it doesn't count in the 'df' computation</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">lh500</span> <span class="op">&lt;-</span> <span class="fu">ARIMA</span><span class="op">(</span><span class="va">lh</span>, order <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">5</span>,<span class="fl">0</span>,<span class="fl">0</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">lh500</span><span class="op">$</span><span class="va">Box.test</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 	Box-Ljung test (lag = 6)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> data:  fit$resid</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> X-squared = 0.48925, df = 1, p-value = 0.4843</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span><span class="co"># round(log(length(lh))) = 4</span></span></span>
<span class="r-in"><span><span class="co"># Default Box.test.lag = min(5+1, 4) = 6,</span></span></span>
<span class="r-in"><span><span class="co"># so df = 1;  without the min(5+1, ...), it would be -1.</span></span></span>
<span class="r-in"><span><span class="va">lh500</span><span class="op">$</span><span class="va">Box.test</span><span class="op">$</span><span class="va">method</span> <span class="co"># lag = 6</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "Box-Ljung test (lag = 6)"</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">lh101</span> <span class="op">&lt;-</span> <span class="fu">ARIMA</span><span class="op">(</span><span class="va">lh</span>, order <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">0</span>,<span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">lh101</span><span class="op">$</span><span class="va">Box.test</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 	Box-Ljung test (lag = 4)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> data:  fit$resid</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> X-squared = 3.5191, df = 2, p-value = 0.1721</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span><span class="co"># works with mixed ARMA</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">USAccD011</span> <span class="op">&lt;-</span> <span class="fu">ARIMA</span><span class="op">(</span><span class="va">USAccDeaths</span>, order <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span>,<span class="fl">1</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                   seasonal <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>order<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span>,<span class="fl">1</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">USAccD011</span><span class="op">$</span><span class="va">Box.test</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 	Box-Ljung test (lag = 4)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> data:  fit$resid</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> X-squared = 2.7568, df = 2, p-value = 0.252</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span><span class="co"># df = round(log(length(USAccDeaths))) - 2:</span></span></span>
<span class="r-in"><span><span class="co"># correct 'df' with nonstationary 'seasonal' as well</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">LakeH200</span> <span class="op">&lt;-</span> <span class="fu">ARIMA</span><span class="op">(</span><span class="va">LakeHuron</span>, order <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">0</span>,<span class="fl">0</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                  xreg <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/time.html" class="external-link">time</a></span><span class="op">(</span><span class="va">LakeHuron</span><span class="op">)</span><span class="op">-</span><span class="fl">1920</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">LakeH200</span><span class="op">$</span><span class="va">Box.test</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 	Box-Ljung test (lag = 5)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> data:  fit$resid</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> X-squared = 0.59148, df = 2, p-value = 0.744</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span><span class="co"># correct 'df' with 'xreg'</span></span></span>
<span class="r-in"><span><span class="va">LakeH200</span><span class="op">$</span><span class="va">r.squared</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.2164241</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## presidents contains NAs</span></span></span>
<span class="r-in"><span><span class="co">## graphs in example(acf) suggest order 1 or 3</span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">require</a></span><span class="op">(</span><span class="va">graphics</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">(</span><span class="va">fit1</span> <span class="op">&lt;-</span> <span class="fu">ARIMA</span><span class="op">(</span><span class="va">presidents</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Call:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> stats::arima(x = x, order = order, seasonal = seasonal, xreg = xreg, include.mean = include.mean, </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     transform.pars = transform.pars, fixed = fixed, init = init, method = method, </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     n.cond = n.cond, optim.control = optim.control, kappa = kappa)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Coefficients:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          ar1  intercept</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       0.8242    56.1505</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> s.e.  0.0555     4.6434</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> sigma^2 estimated as 85.47:  log likelihood = -416.89,  aic = 839.78</span>
<span class="r-in"><span><span class="va">fit1</span><span class="op">$</span><span class="va">Box.test</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 	Box-Ljung test (lag = 5)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> data:  fit$resid</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> X-squared = 12.718, df = 4, p-value = 0.01274</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/stats/tsdiag.html" class="external-link">tsdiag</a></span><span class="op">(</span><span class="va">fit1</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="ARIMA-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="co">##</span></span></span>
<span class="r-in"><span><span class="co">## Example with multiple 'xreg' variables</span></span></span>
<span class="r-in"><span><span class="co">##</span></span></span>
<span class="r-in"><span><span class="va">tLH</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/time.html" class="external-link">time</a></span><span class="op">(</span><span class="va">LakeHuron</span><span class="op">)</span><span class="op">-</span><span class="fl">1920</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">tLH2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span>timeLH.1920 <span class="op">=</span> <span class="va">tLH</span>, time.sq <span class="op">=</span> <span class="va">tLH</span><span class="op">*</span><span class="va">tLH</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">LakeH200.</span> <span class="op">&lt;-</span> <span class="fu">ARIMA</span><span class="op">(</span><span class="va">LakeHuron</span>, order<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">0</span>,<span class="fl">0</span><span class="op">)</span>, xreg<span class="op">=</span><span class="va">tLH2</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">LakeH200.</span><span class="op">$</span><span class="va">r.squared</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.3524303</span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Georgi N. Boshnakov.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

    </footer></div>

  

  

  </body></html>

